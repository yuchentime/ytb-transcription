# YTB2Voice

一个给普通用户用的桌面工具：把 YouTube 视频里的语音，自动变成你想听的目标语言音频。

核心流程是：
下载视频 -> 提取音频 -> 语音转文字 -> 翻译 -> AI 配音 -> 导出结果

---

## 这个工具能帮你做什么

- 粘贴一个 YouTube 链接，自动跑完整流程，不需要手动拼接脚本
- 支持中文/英文/日文目标语言（用于翻译结果输出）
- 支持多种翻译与 TTS 服务提供方（在设置页可切换）
- 内置任务队列：可排队、暂停/恢复、调整等待任务顺序
- 保留任务历史：可查看、重试、导出音频/转录/翻译文件
- 首次运行自动准备必要运行环境（yt-dlp / ffmpeg / Python / Whisper / Deno）

---

## 先看这 3 件事（避免踩坑）

1. 这是桌面端应用（Electron），不是网页服务。
2. 翻译和 TTS 依赖你配置的第三方 API（需要你自己的 API Key）。
3. 请只处理你有合法使用权的内容，避免版权或平台条款风险。

---

## 5 分钟上手（普通用户版）

### 1) 安装应用

- 推荐从仓库的 Releases 页面下载对应系统安装包（macOS / Windows）
- 如果你是开发者，也可以从源码运行（见文末）

### 2) 首次启动，等待运行环境初始化

首次运行会自动下载和安装一些组件（例如 yt-dlp、ffmpeg、Whisper 相关运行时）。  
这一步会比平时慢，属于正常现象。

如果你的网络对 GitHub / Python 包源有限制，初始化可能失败，可先切换网络后重试。

### 3) 打开「设置」并完成基础配置

至少需要配置两块：

- **翻译设置**
  - 选择翻译 Provider（如 MiniMax / DeepSeek / GLM / Kimi / Custom）
  - 填写 API Key、Base URL
  - 选择翻译模型
  - 可点击「连通测试」先验证

- **语音合成设置（TTS）**
  - 选择 TTS Provider（如 MiniMax / OpenAI / GLM / Qwen）
  - 填写 API Key、Base URL
  - 选择 TTS 模型、目标语言、音色

补充：

- Qwen 提供了中国/新加坡/美国区域入口，按你的 Key 所属区域选即可
- 遇到受限视频可在「YouTube 下载鉴权」里切换 Browser Cookies 或 Cookies 文件

### 4) 回到「任务」页提交链接

- 粘贴 YouTube 链接
- 选择目标语言
- 点击「提交任务」

任务会进入队列并按顺序执行。你可以在任务页实时看到状态、进度与日志。

### 5) 获取结果

任务完成后可以：

- 直接播放合成音频
- 下载导出结果
- 打开所在目录
- 在「历史」页回看、重试或再次导出

---

## 常见使用场景

### 场景 A：只想快速得到中文配音

- 目标语言选 `zh`
- 翻译和 TTS 选择你已有 Key 的同一家服务商（通常最省事）
- 保持默认参数，先跑通一条任务再微调

### 场景 B：YouTube 视频报权限或地区限制

- 设置 -> YouTube 下载鉴权
- 优先尝试 `Browser Cookies`（对本机用户最省心）
- 如果跨设备或自动化环境，再用 `Cookies 文件`

### 场景 C：任务多，怕互相打断

- 直接连续提交，交给队列排队
- 在「队列」页暂停/恢复，或调整 waiting 任务顺序

---

## 常见问题（FAQ）

### Q1：为什么第一次特别慢？

首次会自动准备运行环境和模型依赖，属于一次性成本。后续会使用缓存，通常明显更快。

### Q2：任务失败后应该先看哪里？

先看任务页日志，重点关注失败阶段：

- downloading：通常是链接无效、网络问题或鉴权不足
- transcribing：通常是运行时/模型准备问题
- translating / synthesizing：通常是 API Key、Base URL、模型配置错误或额度问题

### Q3：为什么提示 401/403？

- 401：多为 API Key 不正确、过期或无权限
- 403：多为服务端拒绝、额度/策略限制，或 YouTube 下载权限不足（可尝试 Cookies）

### Q4：语音听起来不自然，怎么调？

在设置里先小步调整：

- `ttsSpeed`（语速）
- `ttsPitch`（音调）
- `ttsVolume`（音量）

每次只改一项，先跑短视频样例对比，最容易找到合适参数。

---

## 隐私与安全说明

- 下载、抽音频、转录等环节主要在本地执行
- 翻译和 TTS 会把文本发送到你配置的第三方服务
- API Key 只应保存在你自己的应用设置中，不要提交到仓库或日志

---

## 从源码运行（开发者）

环境建议：

- Node.js 20+
- npm 10+
- macOS / Windows

启动开发环境：

```bash
npm install
npm run dev
```

质量检查：

```bash
npm run lint
npx tsc --noEmit
npm run build
```

常用打包命令：

```bash
npm run dist:mac
npm run dist:win
npm run dist:all
```

---

## 项目结构（快速定位）

- `src/`：前端界面（React）
- `electron/`：主进程与任务执行引擎
- `electron/core/task-engine/`：下载、转录、翻译、TTS 的编排逻辑
- `electron/core/db/`：SQLite 数据与 DAO
- `docs/`：产品文档、开发拆解与发布说明

---

如果你是第一次接触这类工具，建议按「5 分钟上手」先跑通一条短视频任务，再逐步调模型和参数。
